[tox]
ignore_basepython_conflict = tRUE
envlist =
    lint
    copyright
    coverage
    docs
    PY3{9,8,7,6,5}
    py27
    pypy{27,39}

[testenv]
basepython = python3.10
usedevelop = True
deps =
    pypy27,py27: unittest2

commands =
    {envpython} -m unittest discover -s {toxinidir}/tests {posargs}

[testenv:flake8]
skip_install = True
deps =
    flake8

commands =
    {envpython} -m flake8 prefixed setup.py setup_helpers.py tests

[testenv:pylint]
skip_install = True
ignore_errors=True
deps =
    pylint
    pyenchant

commands =
    {envpython} -m pylint prefixed setup setup_helpers tests

[testenv:specialist]
basepython = python3.11
skip_install = True
ignore_errors=True
deps =
    specialist >= 0.2.1

# -h --output {toxinidir}\.specialist
commands =
    {envpython} -m specialist --output {toxinidir}/.specialist --targets prefixed/*.py -m unittest discover -s {toxinidir}/tests {posargs}

[testenv:copyright]
skip_install = True
ignore_errors = True

commands =
    {envpython} setup_helpers.py copyright

[testenv:lint]
skip_install = True
ignore_errors=True
deps =
    {[testenv:flake8]deps}
    {[testenv:pylint]deps}

commands =
    {[testenv:flake8]commands}
    {[testenv:pylint]commands}

[testenv:coverage]
deps =
    coverage

commands =
    {envpython} -m coverage run -m unittest discover -s {toxinidir}/tests {posargs}
    {envpython} -m coverage report

[testenv:codecov]
passenv = CI TRAVIS TRAVIS_*
deps =
    {[testenv:coverage]deps}
    codecov

commands =
    {[testenv:coverage]commands}
    {envpython} -m codecov

[testenv:docs]
deps =
    sphinx
    sphinxcontrib-spelling
    sphinx_rtd_theme

commands=
    {envpython} setup_helpers.py spelling-clean
    {envpython} setup.py spelling
    {envpython} setup_helpers.py spelling
    {envpython} setup.py html
